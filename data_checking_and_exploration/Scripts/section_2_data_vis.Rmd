---
title: "R Notebook"
output: html_notebook
---
Line graphs that match section 2: TX_NEW and HTS_TST_POST, testing all the way through PreP, include value labels, quarter on the y axis, jsut the indicator values, a line chart with all the vlaues labeled for the last year

2a
```{r}
indicators_2a <- c("HTS_TST_POS", "TX_NEW")

measure_trends_2a <- qcheck %>% filter(disagg == "KP", results!=0, indicator %in% indicators_2a) %>%
  group_by(fyq, indicator) %>%
  summarise(sum.results=sum(results)) %>%
  pivot_wider(values_from = sum.results, names_from = indicator) %>% pivot_longer(cols = HTS_TST_POS:TX_NEW, names_to = "indicator", values_to = "results") %>% na.omit()

measure_trends_2a %>% ggplot2::ggplot(aes(x = fyq, y = results, group = indicator)) + geom_line(aes(color = indicator)) + si_style()
```

2b
```{r}
indicators_2b <- c("TX_CURR","TX_NEW", "TX_NET_NEW")

measure_trends_2b <- qcheck %>% filter(disagg == "KP", results!=0, indicator == "TX_CURR") %>%
  group_by(fyq, indicator) %>%
  summarise(sum.results=sum(results)) %>%
  pivot_wider(values_from = sum.results, names_from = indicator) %>% na.omit()

measure_trends_2b %>% ggplot2::ggplot(aes(x = fyq, y = TX_CURR)) + geom_line() + geom_point() + si_style()
```
2c: need to add vlc and vls percentages
```{r}
indicators_2c <- c("TX_PVLS_N", "TX_PVLS_D", "TX_CURR_Lag2")

measure_trends_2c<- qcheck %>% filter(disagg == "KP", results!=0, indicator %in% indicators_2c) %>%
  group_by(fyq, indicator) %>%
  summarise(sum.results=sum(results))  %>% 
  pivot_wider(values_from = sum.results, names_from = indicator) %>%
  mutate(vls = TX_PVLS_N/TX_PVLS_D,
         vlc = TX_PVLS_D/TX_CURR_Lag2) %>%
  select(fyq, TX_PVLS_N, TX_PVLS_D, vlc, vls) %>%
  pivot_longer(cols = TX_PVLS_N:vls, names_to = "vl", values_to = "value")

ggplot(measure_trends_2c, aes(x = fyq, y = value, group = vl)) + geom_col(aes(fill = vl), position = position_dodge()) #+ geom_label(position = position_stack(vjust = 0.9), aes(label = percent(ach, accuracy = 0.1))) + si_style()
```
2d
```{r}
measure_trends_2d <- qcheck %>% filter(disagg == "KP", results!=0, indicator == "HTS_TST_POS") %>%
  group_by(fyq, indicator, keypop) %>%
  summarise(sum.results=sum(results)) %>%
  pivot_wider(values_from = sum.results, names_from = indicator) %>% na.omit()

measure_trends_2d %>% ggplot2::ggplot(aes(x = fyq, y = HTS_TST_POS, group = keypop)) + geom_line(aes(color = keypop)) + si_style()
```
2e
```{r}

```
2e2
```{r}

```
2f
```{r}

```
